{% extends "base.html" %}

{% block title %}Dashboard - ABoroOffice{% endblock %}

{% block content %}
<div id="dashboard-main">
    {% include "partials/dashboard_main.html" %}
</div>
<script>
    (function () {
        const target = document.getElementById('dashboard-main');
        if (!target) return;

        let lastHtml = target.innerHTML;

        async function refreshPlugins() {
            try {
                const response = await fetch('/dashboard/plugins/', { cache: 'no-store' });
                if (!response.ok) return;
                const html = await response.text();
                if (html !== lastHtml) {
                    target.innerHTML = html;
                    lastHtml = html;
                }
            } catch (e) {
                // Silent fail; keep current view.
            }
        }

        // Initial refresh and then every 5 seconds.
        refreshPlugins();
        setInterval(refreshPlugins, 5000);
    })();
</script>
{% endblock %}
