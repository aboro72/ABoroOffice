{% extends "erp/_app_base.html" %}
{% load i18n %}
{% block title %}ERP Pricing Hilfe{% endblock %}
{% block app_breadcrumb %}ERP Pricing Hilfe{% endblock %}
{% block app_actions %}
    <a class="btn btn-outline-secondary" href="/erp/help/">{% trans "Zurück" %}</a>
    <a class="btn btn-outline-primary" href="/admin-dashboard/">{% trans "Admin-Dashboard" %}</a>
{% endblock %}

{% block app_content %}

    <div class="row g-3">
        <div class="col-lg-7">
            <div class="card mb-3">
                <div class="card-header">{% trans "Preislogik (Standard)" %}</div>
                <div class="card-body">
                    <ol class="mb-0">
                        <li>{% trans "Netto-Einkaufspreis (EK) wird im Wareneingang gesetzt." %}</li>
                        <li>{% trans "Mindesmarge + Unterbietungs-Range werden angewendet." %}</li>
                        <li>{% trans "Bei Konkurrenzpreis wird ein Zielpreis darunter berechnet." %}</li>
                        <li>{% trans "Rundung auf 0,05 (Netto und Brutto)." %}</li>
                        <li>{% trans "Brutto = Netto + MwSt." %}</li>
                    </ol>
                </div>
            </div>

            <div class="card mb-3">
                <div class="card-header">{% trans "Provider" %}</div>
                <div class="card-body">
                    <ul class="mb-0">
                        <li><strong>Manuell</strong>: Kein Abruf, Preis wird manuell gepflegt.</li>
                        <li><strong>Custom API</strong>: Empfohlen. Stabil und rechtlich sauber.</li>
                        <li><strong>Geizhals</strong>: Kann blocken; nur wenn TOS/Robots erlaubt.</li>
                    </ul>
                </div>
            </div>

            
            <div class="card mb-3">
                <div class="card-header">{% trans "Beispiel-Berechnungen" %}</div>
                <div class="card-body">
                    <p class="mb-2">{% trans "Beispiele mit Standardwerten (Mindestmarge 20%, Unterbieten 3-10%, MwSt 19%, Rundung 0,05):" %}</p>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>{% trans "EK Netto" %}</th>
                                    <th>{% trans "Konkurrenz Netto" %}</th>
                                    <th>{% trans "Ziel Netto" %}</th>
                                    <th>{% trans "Ziel Brutto" %}</th>
                                    <th>{% trans "Hinweis" %}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>{% trans "100,00" %}</td>
                                    <td>-</td>
                                    <td>{% trans "120,00" %}</td>
                                    <td>{% trans "142,80" %}</td>
                                    <td>{% trans "Nur Mindestmarge" %}</td>
                                </tr>
                                <tr>
                                    <td>{% trans "100,00" %}</td>
                                    <td>{% trans "150,00" %}</td>
                                    <td>{% trans "138,50" %}</td>
                                    <td>{% trans "164,80" %}</td>
                                    <td>{% trans "Konkurrenzpreis unterboten (? 6,5%)" %}</td>
                                </tr>
                                <tr>
                                    <td>{% trans "100,00" %}</td>
                                    <td>{% trans "110,00" %}</td>
                                    <td>{% trans "120,00" %}</td>
                                    <td>{% trans "142,80" %}</td>
                                    <td>{% trans "Unterbieten waere zu niedrig, Mindestmarge greift" %}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="text-muted small">{% trans "Rundung erfolgt auf 0,05 (z.B. 138,47 => 138,50)." %}</div>
                </div>
            </div>
<div class="card mb-3">
                <div class="card-header">{% trans "Custom API Setup" %}</div>
                <div class="card-body">
                    <ol class="mb-0">
                        <li>Service starten: <code>tools/competitor_api/README.md</code></li>
                        <li>Provider = <strong>Custom API</strong></li>
                        <li>URL: <code>http://127.0.0.1:8010/price</code></li>
                        <li>{% trans "API-Key setzen (Authorization: Bearer)" %}</li>
                    </ol>
                </div>
            </div>

            <div class="card mb-3">
                <div class="card-header">{% trans "Debug" %}</div>
                <div class="card-body">
                    <p class="mb-2">{% trans "Letzter Abruf inkl. Quelle und HTML-Auszug:" %}</p>
                    <a class="btn btn-outline-secondary" href="/erp/competitor-debug/">{% trans "Konkurrenz-Debug öffnen" %}</a>
                </div>
            </div>
        </div>

        <div class="col-lg-5">
            <div class="card mb-3">
                <div class="card-header">{% trans "Best Practices" %}</div>
                <div class="card-body">
                    <ul class="mb-0">
                        <li>{% trans "Unterbietung klein halten (3-10%)." %}</li>
                        <li>{% trans "Mindestmarge je Branche definieren." %}</li>
                        <li>{% trans "Wareneingang immer mit EK pflegen." %}</li>
                        <li>{% trans "Debug nutzen, wenn Preise fehlen." %}</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <div class="card-header">{% trans "Beispiel-Request" %}</div>
                <div class="card-body">
                    <pre class="bg-light p-3 rounded"><code>GET /price?q=Kynast%20Raeucherofen
Authorization: Bearer &lt;API_KEY&gt;
</code></pre>
                </div>
            </div>
        </div>
    </div>
{% endblock %}




