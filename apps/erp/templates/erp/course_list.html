{% extends "erp/_list_base.html" %}
{% load i18n %}

{% block title %}Veranstaltungen{% endblock %}

{% block app_breadcrumb %}Veranstaltungen{% endblock %}
{% block list_heading %}Veranstaltungen{% endblock %}
{% block list_actions %}
    <a class="btn btn-primary" href="/erp/courses/create/">{% trans "Neu" %}</a>
{% endblock %}

{% block list_filters %}
<form method="get" class="row g-2 align-items-end">
    <div class="col-md-3">
        <label class="form-label">{% trans "Status" %}</label>
        <select class="form-select" name="status">
            <option value="">Alle</option>
            {% for key, label in status_choices %}
            <option value="{{ key }}" {% if filters.status == key %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-4">
        <label class="form-label">{% trans "Kunde" %}</label>
        <select class="form-select" name="customer">
            <option value="">Alle</option>
            {% for c in customers %}
            <option value="{{ c.id }}" {% if filters.customer == c.id|stringformat:"s" %}selected{% endif %}>{{ c.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-3">
        <label class="form-label">{% trans "Externer Mitarbeiter" %}</label>
        <select class="form-select" name="external_employee">
            <option value="">Alle</option>
            {% for i in external_employees %}
            <option value="{{ i.id }}" {% if filters.external_employee == i.id|stringformat:"s" %}selected{% endif %}>{{ i.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-2 d-grid">
        <button class="btn btn-outline-primary" type="submit">{% trans "Filtern" %}</button>
    </div>
</form>
{% endblock %}

{% block list_content %}
<div class="table-responsive">
    <table class="table table-hover mb-0">
        <thead class="table-light">
            <tr>
                <th>{% trans "Event" %}</th>
                <th>{% trans "Titel" %}</th>
                <th>{% trans "Kunde" %}</th>
                <th>{% trans "Externer MA" %}</th>
                <th>{% trans "Status" %}</th>
                <th>{% trans "Preis Netto" %}</th>
                <th>{% trans "Preis Brutto" %}</th>
                <th>{% trans "Start" %}</th>
                <th>{% trans "Ende" %}</th>
                <th>{% trans "Kapazit√§t" %}</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for c in courses %}
            <tr>
                <td>{{ c.event_number|default:"-" }}</td>
                <td><a href="/erp/courses/{{ c.id }}/">{{ c.title }}</a></td>
                <td>{{ c.customer|default:"-" }}</td>
                <td>{% for inst in c.instructors.all %}{{ inst.name }}{% if not forloop.last %}, {% endif %}{% empty %}-{% endfor %}</td>
                <td>{{ c.get_status_display }}</td>
                <td>{{ c.price_net }}</td>
                <td>{{ c.price_gross }}</td>
                <td>{{ c.start_date|default:"-" }}</td>
                <td>{{ c.end_date|default:"-" }}</td>
                <td>{{ c.capacity }}</td>
                <td class="text-end"><a class="btn btn-sm btn-outline-secondary" href="/erp/courses/{{ c.id }}/edit/">{% trans "Bearbeiten" %}</a></td>
            </tr>
            {% empty %}
            <tr><td colspan="11" class="text-center text-muted py-3">{% trans "Keine Veranstaltungen." %}</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
